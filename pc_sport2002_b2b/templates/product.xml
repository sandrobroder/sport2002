<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!--=================== Product ========================-->
    
    
    <!-- ==================== Ajax Add to cart =================== -->
    <template id="products_add_to_cart_ept_process" inherit_id="website_sale.products_add_to_cart">
        <xpath expr="//t[@t-if='product_variant_id']/a[hasclass('a-submit')]" position="attributes">
            <attribute name="t-if">request.env.user.name != 'Public user'</attribute>
        </xpath>
    </template>

    <template id="pc_ept_price_slider_block" inherit_id="website_sale.products_attributes"
              name="PC View Filter Range Price" priority="3000">
        <xpath expr="//form" position="inside">
            <t t-if="request.env.user.name != 'Public user'">
                <t t-if="website.is_price_range_filter and website.price_filter_on">
                    <t t-set="curr_web" t-value="request.website.get_current_website()"/>
                    <t t-set="range_values" t-value='website.get_min_max_prices(search,category,attrib_values)'/>
                    <t t-if="range_values and range_values[2] and range_values[3]">
                        <input type="hidden" id="price_slider_min" t-att-value="range_values[2]"/>
                        <input type="hidden" id="price_slider_max" t-att-value="range_values[3]"/>
                        <div class="ept_price_slider_block">
                            <div class="price_filter_head te_fa-plus">
                                <span class="m-0 te_pricerange_title">Price Range</span>
                                <a class="price_filter_reset">(Reset)</a>
                            </div>
                            <div class="te_pricerange_content">
                                <div class="d-block mb8 te_price_filter_amount">
                                    <div class="d-inline-block">
                                        <label t-att-class="'d-none' if website.currency_id.position == 'after' else ''"
                                               t-field="website.currency_id.symbol"/>
                                        <span class="ept_price_min" t-esc="range_values[2]"/>
                                        <label t-att-class="'d-none' if website.currency_id.position == 'before' else ''"
                                               t-field="website.currency_id.symbol"/>
                                    </div>
                                    <div class="d-inline-block pull-right">
                                        <label t-att-class="'d-none' if website.currency_id.position == 'after' else ''"
                                               t-field="website.currency_id.symbol"/>
                                        <span class="ept_price_max" t-esc="range_values[3]"/>
                                        <label t-att-class="'d-none' if website.currency_id.position == 'before' else ''"
                                               t-field="website.currency_id.symbol"/>
                                    </div>
                                </div>
                                <div id="ept_price_slider"/>
                                <div class="te_price_wrap">
                                    <div class="te_price_min">
                                        <label t-att-class="'d-none' if website.currency_id.position == 'after' else ''"
                                               t-field="website.currency_id.symbol"/>
                                        <input name="min_price" type="number" class="sliderValue ept_price_min"
                                               data-index="0"
                                               t-att-value="range_values[0] or 1"/>
                                        <label t-att-class="'d-none' if website.currency_id.position == 'before' else ''"
                                               t-field="website.currency_id.symbol"/>
                                    </div>
                                    <div class="te_price_wrap_line">-</div>
                                    <div class="te_price_max">
                                        <label t-att-class="'d-none' if website.currency_id.position == 'after' else ''"
                                               t-field="website.currency_id.symbol"/>
                                        <input name="max_price" type="number" class="sliderValue ept_price_max"
                                               data-index="1"
                                               t-att-value="range_values[1]"/>
                                        <label t-att-class="'d-none' if website.currency_id.position == 'before' else ''"
                                               t-field="website.currency_id.symbol"/>
                                    </div>
                                </div>
                                <span class="ept_price_slider_error"/>
                                <span class="w-100 btn btn-primary mt16 rounded py-1" id="price_slider_filter">Apply
                                    Filter
                                </span>
                            </div>
                        </div>
                    </t>
                </t>
            </t>
        </xpath>
    </template>

    <template id="pc_product_wishlist_ept" inherit_id="website_sale_wishlist.product_wishlist" priority="1000">
        <xpath expr="//table[@id='o_comparelist_table']" position="replace">
            <table
                    class="table table-bordered table-striped table-hover text-center table-comparator t_wish_table"
                    id="o_comparelist_table">
                <body>
                    <t t-foreach="wishes" t-as="wish">
                        <tr t-att-data-wish-id='wish.id' t-att-data-product-id='wish.product_id.id'
                            class="te_fav_product_main align-top">
                            <td class='te_w_img align-top'>
                                <a t-att-href="'/shop/product/%s' % slug(wish.product_id.product_tmpl_id)">
                                    <img t-attf-src="/web/image/product.product/#{wish.product_id.id}/image_128"
                                         class="img img-fluid" style="margin:auto;" alt="Product image"/>
                                </a>
                            </td>
                            <td class="te_w_detail align-top text-left">
                                <div t-attf-class="te_wish_name mb8 #{'te_2_line' if (website.number_of_product_line == '2') else 'te_3_line' if (website.number_of_product_line == '3') else ''}">
                                    <a t-att-href="'/shop/product/%s' % slug(wish.product_id.product_tmpl_id)">
                                        <t t-esc="wish.product_id.display_name"/>
                                    </a>
                                </div>
                                <t t-if="request.env.user.name != 'Public user'">
                                    <div class="te_wish_price mb8">
                                        <t t-set="combination_info"
                                           t-value="wish.product_id._get_combination_info_variant()"/>
                                        <t t-esc="combination_info['price']"
                                           t-options="{'widget': 'monetary', 'display_currency': website.pricelist_id.currency_id}"/>
                                    </div>
                                </t>
                                <div class='te_wish_btn'>
                                    <input name="product_id" t-att-value="wish.product_id.id"
                                           type="hidden"/>
                                    <t t-if="request.env.user.name != 'Public user'">
                                        <button type="button" role="button"
                                                class="btn btn-link o_wish_add mb4">
                                            <i class="fa fa-shopping-cart mr4"/>Add
                                            <span class='d-none d-md-inline'>to Cart</span>
                                        </button>
                                    </t>
                                    <button type="button" class="btn btn-link o_wish_rm no-decoration text-danger">
                                        <i class='fa fa-trash-o mr4'/>
                                        Remove
                                    </button>
                                </div>
                            </td>
                        </tr>
                    </t>
                </body>
            </table>
        </xpath>
        <!--		<xpath expr="//div[hasclass('container')]" position="after">-->
        <!--	    <t t-call="theme_clarico_vega.recently_viewed_ept">-->
        <!--					<t t-set="recent_data" t-value="website.get_recently_viewed_items()"/>-->
        <!--				</t>-->
        <!--	    </xpath>-->
    </template>

<!--     <template id="quick_view_template_process" inherit_id="emipro_theme_base.quick_view_container"
              name="Quick View Template Process" priority="300">
        <xpath expr="//div[hasclass('quick_view_content')]" position="attributes">
            <attribute name="class">quick_view_content d-flex align-content-center flex-wrap</attribute>
        </xpath>
        <xpath expr="//div[hasclass('quick_view_content')]" position="inside">
            <t t-set="combination" t-value="product._get_first_possible_combination()"/>
            <t t-set="combination_info"
               t-value="product._get_combination_info(combination, add_qty=add_qty or 1, pricelist=pricelist)"/>
            <t t-set="product_variant" t-value="product.env['product.product'].browse(combination_info['product_id'])"/>
            <section
                    t-attf-class="container-fluid py-2 oe_website_sale #{'discount' if combination_info['has_discounted_price'] else ''}"
                    id="product_detail">
                <div class="row">
                    <div class="col-md-6 col-xl-6">
                        <t t-call="website_sale.shop_product_carousel"/>
                    </div>

                    <div class="col-md-6 col-xl-6" id="product_details">
                        <t t-if="request.website.viewref('theme_clarico_vega.clarico_shop_products_label').active">
                            <t t-if="product.label_line_ids">
                                <t t-foreach="product.label_line_ids" t-as="labels">
                                    <t t-if="labels.website_id.id == website.id">
                                        <div class="te_prod_label"
                                             t-attf-style="background-color:#{labels.label.html_color};color:#{labels.label.font_html_color}">
                                            <div class="te_label_tag" t-field="labels.label.name"/>
                                        </div>
                                    </t>
                                </t>
                            </t>
                        </t>
                        <h1 itemprop="name" t-field="product.name" class="te_product_name">Product Name</h1>
                        <t t-set="is_review_rating_enabled"
                           t-value="request.website.viewref('website_sale.product_comment').active"/>
                        <t t-if="is_review_rating_enabled">
                            <span t-if="product.rating_avg > 0" class="rating-avg">
                                <span t-esc="product.rating_avg"/>
                                <span class="fa fa-star"/>
                                <span class="product-separator">|</span>
                                <span t-esc="product.rating_count"/>
                            </span>
                        </t>
                        <div class="o_not_editable">
                            <p t-field="product.description_sale" class="te_prod_desc"/>
                        </div>
                        <span itemprop="url" style="display:none;" t-esc="product.website_url"/>
                        <form t-if="product._is_add_to_cart_possible()" action="/shop/cart/update" method="POST">
                            <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()"/>
                            <div class="js_product js_main_product">
                                <t t-call="website_sale.product_price"/>
                                <t t-placeholder="select">
                                    <input type="hidden" class="product_id" name="product_id"
                                           t-att-value="product_variant.id"/>
                                    <input type="hidden" class="product_template_id" name="product_template_id"
                                           t-att-value="product.id"/>
                                    <t t-if="combination" t-call="sale.variants">
                                        <t t-set="ul_class" t-value="'flex-column'"/>
                                        <t t-set="parent_combination" t-value="None"/>
                                    </t>
                                    <t t-else="">
                                        <ul class="d-none js_add_cart_variants"
                                            t-att-data-attribute_exclusions="{'exclusions: []'}"/>
                                    </t>
                                </t>
                                <p t-if="True" class="css_not_available_msg alert alert-warning">This combination does
                                    not exist.
                                </p>
                                <t t-set="qty_show"
                                   t-value="request.website.viewref('website_sale.product_quantity').active"/>
                                <t t-set="buy_now_show"
                                   t-value="request.website.viewref('website_sale.product_buy_now').active"/>
                                <t t-if="qty_show">
                                    <div class="css_quantity input-group oe_website_spinner te_product_quantity"
                                         contenteditable="false">
                                        <div class="input-group-prepend">
                                            <a t-attf-href="#" class="btn btn-secondary js_add_cart_json"
                                               aria-label="Remove one"
                                               title="Remove one">
                                                <span class="fa fa-minus"/>
                                            </a>
                                        </div>
                                        <input type="text" class="form-control quantity" data-min="1" name="add_qty"
                                               value="1"/>
                                        <div class="input-group-append">
                                            <a t-attf-href="#" class="btn btn-secondary float_left js_add_cart_json"
                                               aria-label="Add one" title="Add one">
                                                <span class="fa fa-plus"/>
                                            </a>
                                        </div>
                                    </div>
                                </t>
                                <t t-set="configurator_state"
                                   t-value="request.env['ir.module.module'].sudo().search([['name', '=', 'sale_product_configurator']])"/>
                                <t t-if="request.env.user.name != 'Public user'">
                                    <t t-if="configurator_state and configurator_state.state == 'installed'">
                                        <a role="button"
                                           t-att-id="'add_to_cart' if not product.optional_product_ids else ''"
                                           t-attf-class="btn btn-primary btn-lg mt16 a-submit te_theme_button quick-add-to-cart #{'disabled out_of_stock' if product.sudo().virtual_available &lt; 1 else ''}"
                                           href="#">
                                            <span class="fa fa-shopping-cart"/>
                                            Add to Cart
                                        </a>
                                    </t>
                                    <t t-else="">
                                        <a role="button"
                                           id="add_to_cart"
                                           t-attf-class="btn btn-primary btn-lg mt16 a-submit te_theme_button quick-add-to-cart #{'disabled out_of_stock' if product.sudo().virtual_available &lt; 1 else ''}"
                                           href="#">
                                            <span class="fa fa-shopping-cart"/>
                                            Add to Cart
                                        </a>
                                    </t>
                                </t>
                                <t t-if="buy_now_show">
                                    <a role="button" id="buy_now"
                                       class="btn btn-outline-primary btn-lg mt16 d-block d-sm-inline-block te_theme_button"
                                       href="#">
                                        <span class="fa fa-bolt"/>
                                        Buy Now
                                    </a>
                                </t>
                                <div class="availability_messages o_not_editable"/>
                                <div id="product_option_block"/>
                                <div>
                                    <a t-attf-class="te_view_full_des_link" itemprop="name"
                                       t-att-href="product.website_url">View full details
                                        <i class="fa fa-long-arrow-right"></i>
                                    </a>
                                </div>
                            </div>
                        </form>
                        <p t-elif="not product.active" class="alert alert-warning">This product is no longer
                            available.
                        </p>
                        <p t-else="" class="alert alert-warning">This product has no valid combination.</p>
                    </div>
                </div>
            </section>
        </xpath>
    </template> -->

    <template id="product_processcontrol_b2b" inherit_id="website_sale.products_item" name="product B2B" priority="300">
        <xpath expr="//div[hasclass('product_price')]" position="replace">
            <div class="product_price" itemprop="offers" itemscope="itemscope" itemtype="http://schema.org/Offer">
                <t t-if="not request.env.user._is_public()">
                    <span t-if="combination_info['price']" t-esc="combination_info['price']" class="te_p_sm"
                          t-options="{'widget': 'monetary', 'display_currency': website.currency_id}"/>
              
                <del t-attf-class="text-danger mr-1 te_p_disc {{'' if combination_info['has_discounted_price'] else 'd-none'}}"
                     style="white-space: nowrap;" t-esc="combination_info['list_price']"
                     t-options="{'widget': 'monetary', 'display_currency': website.currency_id}"/>
                <span itemprop="price" style="display:none;" t-esc="combination_info['price']"/>
                <span itemprop="priceCurrency" style="display:none;" t-esc="website.currency_id.name"/>
                <div t-attf-class="te_discount {{'' if combination_info['has_discounted_price'] else 'd-none'}}">
                    <t t-set="difference"
                       t-value="round(combination_info['list_price'] - combination_info['price'],2)"/>
                    <t t-set="discount"
                       t-value="round(difference*100/combination_info['list_price']) if combination_info['list_price'] &gt; 0 else 0"/>
                    <span class="te_percentage" t-esc="'(%s'%(discount)+'% Off)'"/>
<!--                     <div class="te_percentage" t-if="discount">
                        <span t-esc="'(%s'%(discount)+'%'"/>
                        Off)
                    </div> -->
                </div>
                      </t>
            </div>
        </xpath>
    </template>
</odoo>
